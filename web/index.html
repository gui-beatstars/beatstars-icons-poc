<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BeatStars Icons</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    /* ---- shadcn/ui Design Tokens (dark, neutral) ---- */
    :root {
      --background: #09090b;
      --foreground: #fafafa;
      --card: #18181b;
      --card-foreground: #fafafa;
      --popover: #18181b;
      --popover-foreground: #fafafa;
      --primary: #fafafa;
      --primary-foreground: #18181b;
      --secondary: #27272a;
      --secondary-foreground: #fafafa;
      --muted: #27272a;
      --muted-foreground: #a1a1aa;
      --accent: #C32D2D;
      --accent-foreground: #ffffff;
      --accent-subtle: rgba(195, 45, 45, 0.08);
      --destructive: #ef4444;
      --border: rgba(255, 255, 255, 0.08);
      --input: rgba(255, 255, 255, 0.12);
      --ring: #a1a1aa;
      --radius: 0.625rem;
      --font-sans: 'Inter', -apple-system, system-ui, sans-serif;
      --font-mono: 'JetBrains Mono', ui-monospace, monospace;
    }

    html { font-size: 16px; }

    body {
      font-family: var(--font-sans);
      background: var(--background);
      color: var(--foreground);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* ---- HEADER ---- */
    .header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(9, 9, 11, 0.80);
      backdrop-filter: blur(12px) saturate(180%);
      -webkit-backdrop-filter: blur(12px) saturate(180%);
      border-bottom: 1px solid var(--border);
    }

    .header-inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 14px 24px;
      display: flex;
      align-items: center;
      gap: 24px;
    }

    /* Logo */
    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
      flex-shrink: 0;
    }

    .logo-mark {
      width: 28px;
      height: 28px;
      background: var(--accent);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo-mark svg { width: 15px; height: 15px; }

    .logo-text {
      font-weight: 600;
      font-size: 1rem;
      color: var(--foreground);
      letter-spacing: -0.01em;
    }

    .logo-text span {
      color: var(--muted-foreground);
      font-weight: 400;
    }

    /* Nav */
    .nav {
      display: flex;
      gap: 4px;
    }

    .nav a {
      display: inline-flex;
      align-items: center;
      padding: 6px 14px;
      border-radius: calc(var(--radius) - 4px);
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--muted-foreground);
      text-decoration: none;
      transition: color 0.15s, background 0.15s;
    }

    .nav a:hover { color: var(--foreground); background: var(--secondary); }
    .nav a.active { color: var(--foreground); background: var(--secondary); }

    /* Search — shadcn Input style */
    .search-wrapper {
      flex: 1;
      max-width: 480px;
      position: relative;
    }

    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted-foreground);
      pointer-events: none;
    }

    .search-input {
      display: flex;
      height: 40px;
      width: 100%;
      border-radius: calc(var(--radius) - 4px);
      border: 1px solid var(--input);
      background: var(--background);
      padding: 8px 52px 8px 38px;
      font-size: 0.875rem;
      font-family: var(--font-sans);
      color: var(--foreground);
      outline: none;
      transition: border-color 0.15s, box-shadow 0.15s;
    }

    .search-input::placeholder { color: var(--muted-foreground); }

    .search-input:focus {
      border-color: var(--ring);
      box-shadow: 0 0 0 2px var(--background), 0 0 0 4px var(--ring);
    }

    .search-kbd {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
      display: inline-flex;
      align-items: center;
      gap: 2px;
      font-family: var(--font-sans);
      font-size: 0.7rem;
      font-weight: 500;
      color: var(--muted-foreground);
      background: var(--secondary);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 2px 6px;
      line-height: 1;
    }

    .search-input:focus ~ .search-kbd { display: none; }

    /* Header meta */
    .header-meta {
      display: flex;
      align-items: center;
      gap: 16px;
      flex-shrink: 0;
    }

    .icon-count {
      font-size: 0.8rem;
      color: var(--muted-foreground);
      font-variant-numeric: tabular-nums;
    }

    .icon-count strong {
      color: var(--foreground);
      font-weight: 500;
    }

    /* ---- TOOLBAR (filters + sort) ---- */
    .toolbar {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px 24px 0;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    /* Row 1: category pills (full width, scrollable) */
    .toolbar-row-categories {
      display: flex;
      align-items: center;
      gap: 8px;
      min-width: 0;
    }

    /* Row 2: style + sort side by side */
    .toolbar-row-controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .toolbar-group {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .toolbar-label {
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--muted-foreground);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-right: 2px;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .toolbar-divider {
      width: 1px;
      height: 20px;
      background: var(--border);
      margin: 0 4px;
      flex-shrink: 0;
    }

    /* Category pills */
    .pill {
      display: inline-flex;
      align-items: center;
      height: 28px;
      padding: 0 10px;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s, color 0.15s;
      border: 1px solid var(--input);
      background: transparent;
      color: var(--muted-foreground);
      white-space: nowrap;
      user-select: none;
      flex-shrink: 0;
    }

    .pill:hover {
      background: var(--secondary);
      border-color: var(--muted-foreground);
      color: var(--foreground);
    }

    .pill.active {
      background: var(--accent);
      border-color: var(--accent);
      color: var(--accent-foreground);
    }

    .pill .pill-count {
      font-size: 0.65rem;
      opacity: 0.7;
      margin-left: 4px;
      font-variant-numeric: tabular-nums;
    }

    .pill.active .pill-count { opacity: 0.9; }

    /* Sort dropdown — shadcn Select style */
    .sort-select {
      display: inline-flex;
      align-items: center;
      height: 28px;
      padding: 0 10px;
      border-radius: calc(var(--radius) - 4px);
      font-size: 0.75rem;
      font-weight: 500;
      font-family: var(--font-sans);
      cursor: pointer;
      border: 1px solid var(--input);
      background: transparent;
      color: var(--muted-foreground);
      outline: none;
      appearance: none;
      -webkit-appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg width='10' height='6' viewBox='0 0 10 6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L5 5L9 1' stroke='%23a1a1aa' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 8px center;
      padding-right: 24px;
      transition: border-color 0.15s, color 0.15s;
    }

    .sort-select:hover {
      border-color: var(--muted-foreground);
      color: var(--foreground);
    }

    .sort-select:focus {
      border-color: var(--ring);
      box-shadow: 0 0 0 2px var(--background), 0 0 0 4px var(--ring);
    }

    .sort-select option {
      background: var(--card);
      color: var(--foreground);
    }

    /* Style filter buttons */
    .style-btn {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      height: 28px;
      padding: 0 10px;
      border-radius: calc(var(--radius) - 4px);
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      border: 1px solid var(--input);
      background: transparent;
      color: var(--muted-foreground);
      transition: background 0.15s, border-color 0.15s, color 0.15s;
      white-space: nowrap;
    }

    .style-btn:hover {
      background: var(--secondary);
      border-color: var(--muted-foreground);
      color: var(--foreground);
    }

    .style-btn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: var(--accent-foreground);
    }

    .style-btn svg {
      width: 13px;
      height: 13px;
    }

    /* Category scroll wrapper */
    .category-scroll {
      display: flex;
      align-items: center;
      gap: 6px;
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
      min-width: 0;
      flex: 1;
      mask-image: linear-gradient(to right, transparent 0, #000 0, #000 calc(100% - 32px), transparent 100%);
      -webkit-mask-image: linear-gradient(to right, transparent 0, #000 0, #000 calc(100% - 32px), transparent 100%);
      padding-right: 32px;
    }

    .category-scroll::-webkit-scrollbar { display: none; }

    /* Spacer to push sort right */
    .toolbar-spacer { flex: 1; min-width: 8px; }

    /* Result count in toolbar row 2 */
    .toolbar-result-count {
      font-size: 0.75rem;
      color: var(--muted-foreground);
      font-variant-numeric: tabular-nums;
      white-space: nowrap;
      flex-shrink: 0;
    }

    /* ---- GRID ---- */
    .main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px 24px 120px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(58px, 1fr));
      gap: 0;
    }

    .icon-cell {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 0.5px solid transparent;
      cursor: pointer;
      transition: background 0.12s, border-color 0.12s;
      position: relative;
    }

    .icon-cell:hover {
      background: var(--secondary);
      border-color: var(--border);
      z-index: 10;
    }

    .icon-cell.selected {
      background: var(--accent-subtle);
      border-color: var(--accent);
      z-index: 2;
    }

    .icon-cell svg {
      color: var(--muted-foreground);
      transition: color 0.12s;
    }

    .icon-cell:hover svg { color: var(--foreground); }
    .icon-cell.selected svg { color: var(--accent); }

    /* Tooltip — shadcn Tooltip style */
    .icon-cell::after {
      content: attr(data-name);
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%);
      background: var(--primary);
      color: var(--primary-foreground);
      font-size: 0.75rem;
      font-weight: 500;
      padding: 4px 10px;
      border-radius: calc(var(--radius) - 4px);
      white-space: nowrap;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.1s;
      z-index: 50;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    .icon-cell:hover::after { opacity: 1; }

    /* ---- MODAL OVERLAY ---- */
    .modal-overlay {
      position: fixed;
      inset: 0;
      z-index: 200;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
    }

    .modal-overlay.open {
      opacity: 1;
      pointer-events: auto;
    }

    /* ---- MODAL NAV CHEVRONS ---- */
    .modal-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--muted-foreground);
      cursor: pointer;
      transition: background 0.15s, color 0.15s, border-color 0.15s;
      z-index: 210;
    }

    .modal-nav:hover {
      background: var(--secondary);
      color: var(--foreground);
      border-color: var(--muted-foreground);
    }

    .modal-nav.prev { left: max(12px, calc(50% - 320px)); }
    .modal-nav.next { right: max(12px, calc(50% - 320px)); }

    @media (max-width: 768px) {
      .modal-nav.prev { left: 6px; }
      .modal-nav.next { right: 6px; }
      .modal-nav { width: 34px; height: 34px; }
    }

    /* ---- MODAL DIALOG ---- */
    .modal {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: calc(var(--radius) + 4px);
      box-shadow: 0 16px 64px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.04);
      width: 90vw;
      max-width: 560px;
      max-height: 85vh;
      overflow-y: auto;
      transform: scale(0.96) translateY(8px);
      transition: transform 0.2s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .modal-overlay.open .modal {
      transform: scale(1) translateY(0);
    }

    .modal-inner {
      padding: 28px 28px 24px;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    /* Top row: name + close */
    .modal-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 16px;
    }

    .modal-header .detail-name {
      font-size: 1.125rem;
      font-weight: 600;
      color: var(--foreground);
      letter-spacing: -0.02em;
    }

    .modal-header .detail-tags {
      font-size: 0.8rem;
      color: var(--muted-foreground);
      margin-top: 4px;
    }

    /* Icon preview — centered */
    .detail-preview {
      width: 100%;
      height: 176px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--secondary);
      border: 1px solid var(--border);
      border-radius: var(--radius);
    }

    .detail-preview svg { color: var(--foreground); }

    /* Sections */
    .modal-section {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .detail-section-label {
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--muted-foreground);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .size-options {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .size-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      height: 32px;
      padding: 0 12px;
      border-radius: calc(var(--radius) - 4px);
      font-family: var(--font-mono);
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s, color 0.15s;
      border: 1px solid var(--input);
      background: transparent;
      color: var(--muted-foreground);
      white-space: nowrap;
    }

    .size-btn:hover {
      background: var(--secondary);
      border-color: var(--muted-foreground);
      color: var(--foreground);
    }

    .size-btn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: var(--accent-foreground);
    }

    /* Code block */
    .detail-code {
      font-family: var(--font-mono);
      font-size: 0.8rem;
      color: var(--muted-foreground);
      background: var(--background);
      border: 1px solid var(--border);
      border-radius: calc(var(--radius) - 4px);
      padding: 12px 16px;
      cursor: pointer;
      transition: border-color 0.15s, color 0.15s;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .detail-code:hover {
      border-color: var(--muted-foreground);
      color: var(--foreground);
    }

    .detail-code.copied {
      border-color: #22c55e;
      color: #22c55e;
    }

    /* Action buttons */
    .detail-actions {
      display: flex;
      gap: 8px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      height: 36px;
      padding: 0 16px;
      border-radius: calc(var(--radius) - 4px);
      font-family: var(--font-sans);
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s, color 0.15s, box-shadow 0.15s;
      border: 1px solid transparent;
      white-space: nowrap;
      outline: none;
    }

    .btn:focus-visible {
      box-shadow: 0 0 0 2px var(--background), 0 0 0 4px var(--ring);
    }

    .btn-default {
      background: var(--accent);
      color: var(--accent-foreground);
      border-color: var(--accent);
    }

    .btn-default:hover { filter: brightness(1.12); }

    .btn-outline {
      background: transparent;
      color: var(--foreground);
      border-color: var(--input);
    }

    .btn-outline:hover {
      background: var(--secondary);
      border-color: var(--muted-foreground);
    }

    .btn-ghost {
      background: transparent;
      color: var(--muted-foreground);
      border-color: transparent;
    }

    .btn-ghost:hover {
      background: var(--secondary);
      color: var(--foreground);
    }

    .btn-icon {
      width: 36px;
      height: 36px;
      padding: 0;
    }

    .btn.copied {
      background: #22c55e;
      border-color: #22c55e;
      color: #fff;
    }

    /* ---- KEYBOARD HINTS ---- */
    .modal-shortcuts {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      padding-top: 4px;
    }

    .shortcut-hint {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.7rem;
      color: var(--muted-foreground);
      opacity: 0.6;
    }

    .shortcut-hint kbd {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 20px;
      height: 20px;
      padding: 0 5px;
      border-radius: 4px;
      font-family: var(--font-sans);
      font-size: 0.65rem;
      font-weight: 500;
      background: var(--secondary);
      border: 1px solid var(--border);
      color: var(--muted-foreground);
      line-height: 1;
    }

    /* ---- CATEGORY SECTION HEADERS (in "by category" sort mode) ---- */
    .category-header {
      grid-column: 1 / -1;
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--muted-foreground);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      padding: 20px 0 8px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 4px;
    }

    .category-header:first-child { padding-top: 0; }

    /* ---- EMPTY STATE ---- */
    .empty-state {
      grid-column: 1 / -1;
      padding: 80px 24px;
      text-align: center;
    }

    .empty-state svg {
      color: var(--muted-foreground);
      margin-bottom: 16px;
      opacity: 0.3;
    }

    .empty-state p {
      color: var(--muted-foreground);
      font-size: 0.9rem;
    }

    .empty-state .hint {
      margin-top: 6px;
      font-size: 0.8rem;
      opacity: 0.5;
    }

    /* ---- RESPONSIVE ---- */
    @media (max-width: 768px) {
      .header-inner { padding: 12px 16px; gap: 12px; }
      .toolbar { padding: 12px 16px 0; gap: 8px; }
      .toolbar-divider { display: none; }
      .toolbar-label { display: none; }
      .toolbar-row-controls { flex-wrap: wrap; gap: 6px; }
      .main { padding: 16px 16px 80px; }
      .grid { grid-template-columns: repeat(auto-fill, minmax(50px, 1fr)); }
      .modal { width: 95vw; }
      .modal-inner { padding: 20px; }
      .detail-preview { height: 120px; }
      .icon-count { display: none; }
      .logo-text { display: none; }
    }

    @media (max-width: 480px) {
      .toolbar { padding: 10px 12px 0; }
      .pill { height: 26px; padding: 0 8px; font-size: 0.7rem; }
      .style-btn { height: 26px; padding: 0 8px; font-size: 0.7rem; }
      .sort-select { height: 26px; font-size: 0.7rem; }
      .toolbar-result-count { font-size: 0.65rem; }
    }
  </style>
</head>
<body>

  <header class="header">
    <div class="header-inner">
      <a class="logo" href="#">
        <div class="logo-mark">
          <svg viewBox="0 0 16 16" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round">
            <circle cx="8" cy="8" r="3" /><path d="M8 2v2M8 12v2M2 8h2M12 8h2" />
          </svg>
        </div>
        <div class="logo-text">BeatStars <span>Icons</span></div>
      </a>

      <nav class="nav">
        <a href="index.html" class="active">Icons</a>
        <a href="deploy.html">Deploy</a>
      </nav>

      <div class="search-wrapper">
        <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
          <circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/>
        </svg>
        <input
          type="text"
          class="search-input"
          id="search"
          placeholder="Search icons…"
          spellcheck="false"
          autocomplete="off"
        />
        <span class="search-kbd">⌘K</span>
      </div>

      <div class="header-meta">
        <span class="icon-count"><strong id="visible-count">0</strong> <span id="count-label">icons</span></span>
      </div>
    </div>
  </header>

  <div class="toolbar" id="toolbar">
    <!-- Row 1: Category pills -->
    <div class="toolbar-row-categories">
      <span class="toolbar-label">Category</span>
      <div class="category-scroll" id="category-pills"></div>
    </div>
    <!-- Row 2: Style + Sort -->
    <div class="toolbar-row-controls">
      <div class="toolbar-group">
        <span class="toolbar-label">Style</span>
        <button class="style-btn active" data-style="all" id="style-all" title="All styles">
          All
        </button>
        <button class="style-btn" data-style="stroke" id="style-stroke" title="Stroke / outline icons">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="9"/></svg>
          Stroke
        </button>
        <button class="style-btn" data-style="fill" id="style-fill" title="Filled / solid icons">
          <svg viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="9"/></svg>
          Fill
        </button>
      </div>
      <div class="toolbar-divider"></div>
      <div class="toolbar-group">
        <span class="toolbar-label">Sort</span>
        <select class="sort-select" id="sort-select">
          <option value="a-z">A &rarr; Z</option>
          <option value="z-a">Z &rarr; A</option>
          <option value="category">By Category</option>
        </select>
      </div>
      <div class="toolbar-spacer"></div>
      <span class="toolbar-result-count" id="toolbar-result-count"></span>
    </div>
  </div>

  <main class="main">
    <div class="grid" id="grid"></div>
  </main>

  <!-- Modal -->
  <div class="modal-overlay" id="modal-overlay">
    <button class="modal-nav prev" id="nav-prev" title="Previous icon (←)">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
    </button>
    <div class="modal" id="modal">
      <div class="modal-inner">
        <div class="modal-header">
          <div>
            <div class="detail-name" id="detail-name"></div>
            <div class="detail-tags" id="detail-tags"></div>
          </div>
          <button class="btn btn-ghost btn-icon" id="detail-close" title="Close (Esc)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M18 6 6 18M6 6l12 12"/></svg>
          </button>
        </div>
        <div class="detail-preview" id="detail-preview"></div>
        <div class="modal-section">
          <div class="detail-section-label">Size</div>
          <div class="size-options" id="size-options">
            <button class="size-btn" data-size="8">8px</button>
            <button class="size-btn" data-size="12">12px</button>
            <button class="size-btn" data-size="16">16px</button>
            <button class="size-btn active" data-size="24">24px</button>
            <button class="size-btn" data-size="32">32px</button>
            <button class="size-btn" data-size="40">40px</button>
            <button class="size-btn" data-size="64">64px</button>
          </div>
        </div>
        <div class="modal-section">
          <div class="detail-section-label">Import</div>
          <div class="detail-code" id="detail-import" title="Click to copy import"></div>
        </div>
        <div class="modal-section">
          <div class="detail-section-label">Usage</div>
          <div class="detail-code" id="detail-usage" title="Click to copy usage"></div>
        </div>
        <div class="detail-actions">
          <button class="btn btn-default" id="btn-copy-svg">Copy SVG</button>
          <button class="btn btn-outline" id="btn-copy-import">Copy Import</button>
        </div>
        <div class="modal-shortcuts">
          <span class="shortcut-hint"><kbd>←</kbd><kbd>→</kbd> Navigate</span>
          <span class="shortcut-hint"><kbd>C</kbd> Copy SVG</span>
          <span class="shortcut-hint"><kbd>Esc</kbd> Close</span>
        </div>
      </div>
    </div>
    <button class="modal-nav next" id="nav-next" title="Next icon (→)">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
    </button>
  </div>

  <!-- Catalog data -->
  <script src="catalog-data.js"></script>

  <script>
    if (!window.BEATSTARS_ICONS) {
      window.BEATSTARS_ICONS = [
        { name: 'PlayIcon', fileName: 'play', kebab: 'play', tags: ['play','start','media'], category: 'Media & Audio', style: 'stroke', svg: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>', importStatement: "import { PlayIcon } from '@beatstars/icons';", jsxUsage: '<PlayIcon size={24} />' },
        { name: 'SearchIcon', fileName: 'search', kebab: 'search', tags: ['search','find'], category: 'General', style: 'stroke', svg: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>', importStatement: "import { SearchIcon } from '@beatstars/icons';", jsxUsage: '<SearchIcon size={24} />' },
      ];
    }
  </script>

  <script>
    // ---- State ----
    let icons = window.BEATSTARS_ICONS || [];
    let filteredIcons = [...icons];
    let selectedIcon = null;
    let selectedSize = 24;
    let activeCategory = 'All';
    let activeStyle = 'all';
    let activeSort = 'a-z';

    // ---- DOM refs ----
    const grid = document.getElementById('grid');
    const searchInput = document.getElementById('search');
    const visibleCount = document.getElementById('visible-count');
    const countLabel = document.getElementById('count-label');
    const modalOverlay = document.getElementById('modal-overlay');
    const modal = document.getElementById('modal');
    const detailPreview = document.getElementById('detail-preview');
    const detailName = document.getElementById('detail-name');
    const detailTags = document.getElementById('detail-tags');
    const detailImport = document.getElementById('detail-import');
    const detailUsage = document.getElementById('detail-usage');
    const detailClose = document.getElementById('detail-close');
    const sizeOptions = document.getElementById('size-options');
    const btnCopySvg = document.getElementById('btn-copy-svg');
    const btnCopyImport = document.getElementById('btn-copy-import');
    const navPrev = document.getElementById('nav-prev');
    const navNext = document.getElementById('nav-next');
    const categoryPills = document.getElementById('category-pills');
    const sortSelect = document.getElementById('sort-select');
    const toolbarResultCount = document.getElementById('toolbar-result-count');

    // Dynamic placeholder
    searchInput.placeholder = `Search ${icons.length} icons\u2026`;

    // ---- Build categories from data ----
    const categoryOrder = [
      'All', 'Arrows', 'Commerce', 'Communication', 'Devices', 'Editing',
      'Files', 'General', 'Layout', 'Location', 'Media & Audio',
      'Security', 'Social & Brands', 'Status', 'Time', 'Users'
    ];
    const categoryCounts = { All: icons.length };
    icons.forEach(icon => {
      const cat = icon.category || 'General';
      categoryCounts[cat] = (categoryCounts[cat] || 0) + 1;
    });
    // Only show categories that have icons
    const activeCategories = categoryOrder.filter(c => categoryCounts[c] > 0);

    function renderCategoryPills() {
      categoryPills.innerHTML = activeCategories.map(cat => `
        <button class="pill${activeCategory === cat ? ' active' : ''}"
                data-category="${cat}"
                title="${cat}">
          ${cat}<span class="pill-count">${categoryCounts[cat]}</span>
        </button>
      `).join('');
    }

    categoryPills.addEventListener('click', (e) => {
      const pill = e.target.closest('.pill');
      if (!pill) return;
      activeCategory = pill.dataset.category;
      renderCategoryPills();
      applyFilters();
    });

    // ---- Style filter ----
    document.querySelectorAll('.style-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        activeStyle = btn.dataset.style;
        document.querySelectorAll('.style-btn').forEach(b => b.classList.toggle('active', b.dataset.style === activeStyle));
        applyFilters();
      });
    });

    // ---- Sort ----
    sortSelect.addEventListener('change', () => {
      activeSort = sortSelect.value;
      applyFilters();
    });

    // ---- SVG helper ----
    function scaleSvg(svg, size) {
      return svg.replace(/<svg([^>]*)>/, (match, attrs) => {
        attrs = attrs.replace(/\s+width="[^"]*"/, '').replace(/\s+height="[^"]*"/, '');
        return `<svg width="${size}" height="${size}"${attrs}>`;
      });
    }

    // ---- Central filter + sort logic ----
    function applyFilters() {
      const q = searchInput.value.toLowerCase().trim();
      const terms = q ? q.split(/\s+/) : [];

      filteredIcons = icons.filter(icon => {
        // Category filter
        if (activeCategory !== 'All' && icon.category !== activeCategory) return false;
        // Style filter
        if (activeStyle !== 'all' && icon.style !== activeStyle) return false;
        // Search
        if (terms.length > 0) {
          const searchable = [icon.name, icon.fileName, icon.category, ...icon.tags].join(' ').toLowerCase();
          if (!terms.every(t => searchable.includes(t))) return false;
        }
        return true;
      });

      // Sort
      switch (activeSort) {
        case 'a-z':
          filteredIcons.sort((a, b) => a.fileName.localeCompare(b.fileName));
          break;
        case 'z-a':
          filteredIcons.sort((a, b) => b.fileName.localeCompare(a.fileName));
          break;
        case 'category':
          filteredIcons.sort((a, b) => {
            const catCmp = a.category.localeCompare(b.category);
            return catCmp !== 0 ? catCmp : a.fileName.localeCompare(b.fileName);
          });
          break;
      }

      renderGrid();
    }

    // ---- Render Grid ----
    function renderGrid() {
      if (filteredIcons.length === 0) {
        grid.innerHTML = `
          <div class="empty-state">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
              <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
            </svg>
            <p>No icons match your filters</p>
            <p class="hint">Try adjusting your search or filters</p>
          </div>
        `;
      } else {
        // When sorting by category, inject section headers
        if (activeSort === 'category' && activeCategory === 'All') {
          let html = '';
          let lastCat = '';
          filteredIcons.forEach((icon, i) => {
            if (icon.category !== lastCat) {
              html += `<div class="category-header">${icon.category}</div>`;
              lastCat = icon.category;
            }
            html += `
              <div class="icon-cell${selectedIcon === icon ? ' selected' : ''}"
                   data-index="${i}"
                   data-name="${icon.kebab}"
                   onclick="selectIcon(${i})">
                ${scaleSvg(icon.svg, 24)}
              </div>`;
          });
          grid.innerHTML = html;
        } else {
          grid.innerHTML = filteredIcons.map((icon, i) => `
            <div class="icon-cell${selectedIcon === icon ? ' selected' : ''}"
                 data-index="${i}"
                 data-name="${icon.kebab}"
                 onclick="selectIcon(${i})">
              ${scaleSvg(icon.svg, 24)}
            </div>
          `).join('');
        }
      }

      visibleCount.textContent = filteredIcons.length;
      countLabel.textContent = filteredIcons.length === 1 ? 'icon' : 'icons';
      // Show result count in toolbar when filtered
      const isFiltered = activeCategory !== 'All' || activeStyle !== 'all' || searchInput.value.trim();
      toolbarResultCount.textContent = isFiltered ? `${filteredIcons.length} result${filteredIcons.length !== 1 ? 's' : ''}` : '';
    }

    // ---- Search ----
    searchInput.addEventListener('input', () => applyFilters());

    // ---- Detail Bar ----
    function selectIcon(index) {
      const icon = filteredIcons[index];
      if (selectedIcon === icon) { closeDetail(); return; }
      selectedIcon = icon;
      openDetail();
      renderGrid();
    }

    function updatePreviewSize(size) {
      selectedSize = size;
      if (!selectedIcon) return;
      detailPreview.innerHTML = scaleSvg(selectedIcon.svg, 96);
      const usageText = `<${selectedIcon.name} size={${size}} />`;
      detailUsage.textContent = usageText;
      detailUsage.onclick = () => copyText(usageText, detailUsage);
      sizeOptions.querySelectorAll('.size-btn').forEach(btn => {
        btn.classList.toggle('active', Number(btn.dataset.size) === size);
      });
    }

    function openDetail() {
      if (!selectedIcon) return;
      detailPreview.innerHTML = scaleSvg(selectedIcon.svg, 96);
      detailName.textContent = selectedIcon.kebab;
      detailTags.textContent = [selectedIcon.category, ...selectedIcon.tags].join(' \u2022 ');
      detailImport.textContent = selectedIcon.importStatement;
      detailImport.onclick = () => copyText(selectedIcon.importStatement, detailImport);
      const usageText = `<${selectedIcon.name} size={${selectedSize}} />`;
      detailUsage.textContent = usageText;
      detailUsage.onclick = () => copyText(usageText, detailUsage);
      sizeOptions.querySelectorAll('.size-btn').forEach(btn => {
        btn.classList.toggle('active', Number(btn.dataset.size) === selectedSize);
      });
      modalOverlay.classList.add('open');
    }

    function closeDetail() {
      modalOverlay.classList.remove('open');
      selectedIcon = null;
      renderGrid();
    }

    function navigateIcon(direction) {
      if (!selectedIcon) return;
      const currentIndex = filteredIcons.indexOf(selectedIcon);
      if (currentIndex === -1) return;
      let nextIndex = currentIndex + direction;
      // Wrap around
      if (nextIndex < 0) nextIndex = filteredIcons.length - 1;
      if (nextIndex >= filteredIcons.length) nextIndex = 0;
      selectedIcon = filteredIcons[nextIndex];
      openDetail();
      renderGrid();
    }

    detailClose.addEventListener('click', closeDetail);
    navPrev.addEventListener('click', () => navigateIcon(-1));
    navNext.addEventListener('click', () => navigateIcon(1));

    // Close on backdrop click
    modalOverlay.addEventListener('click', (e) => {
      if (e.target === modalOverlay) closeDetail();
    });

    // ---- Size selector ----
    sizeOptions.addEventListener('click', (e) => {
      const btn = e.target.closest('.size-btn');
      if (!btn) return;
      updatePreviewSize(Number(btn.dataset.size));
    });

    // ---- Copy ----
    btnCopySvg.addEventListener('click', () => {
      if (selectedIcon) copyText(selectedIcon.svg, btnCopySvg);
    });

    btnCopyImport.addEventListener('click', () => {
      if (selectedIcon) copyText(selectedIcon.importStatement, btnCopyImport);
    });

    async function copyText(text, el) {
      try {
        await navigator.clipboard.writeText(text);
        const orig = el.textContent;
        el.textContent = 'Copied!';
        el.classList.add('copied');
        setTimeout(() => {
          el.textContent = orig;
          el.classList.remove('copied');
        }, 1200);
      } catch {}
    }

    // ---- Keyboard ----
    document.addEventListener('keydown', (e) => {
      const isModalOpen = modalOverlay.classList.contains('open');

      if (e.key === 'Escape') { closeDetail(); return; }

      if ((e.key === '/' || (e.metaKey && e.key === 'k')) && document.activeElement !== searchInput) {
        e.preventDefault();
        searchInput.focus();
        return;
      }

      // Modal-only shortcuts (only when not typing in search)
      if (isModalOpen && document.activeElement !== searchInput) {
        if (e.key === 'ArrowLeft') { e.preventDefault(); navigateIcon(-1); return; }
        if (e.key === 'ArrowRight') { e.preventDefault(); navigateIcon(1); return; }
        if (e.key === 'c' && !e.metaKey && !e.ctrlKey && !e.altKey) {
          e.preventDefault();
          if (selectedIcon) copyText(selectedIcon.svg, btnCopySvg);
          return;
        }
      }
    });

    // ---- Init ----
    renderCategoryPills();
    applyFilters();
  </script>
</body>
</html>
