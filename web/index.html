<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BeatStars Icons</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    /* ---- shadcn/ui Design Tokens (dark, neutral) ---- */
    :root {
      --background: #09090b;
      --foreground: #fafafa;
      --card: #18181b;
      --card-foreground: #fafafa;
      --popover: #18181b;
      --popover-foreground: #fafafa;
      --primary: #fafafa;
      --primary-foreground: #18181b;
      --secondary: #27272a;
      --secondary-foreground: #fafafa;
      --muted: #27272a;
      --muted-foreground: #a1a1aa;
      --accent: #C32D2D;
      --accent-foreground: #ffffff;
      --accent-subtle: rgba(195, 45, 45, 0.08);
      --destructive: #ef4444;
      --border: rgba(255, 255, 255, 0.08);
      --input: rgba(255, 255, 255, 0.12);
      --ring: #a1a1aa;
      --radius: 0.625rem;
      --font-sans: 'Inter', -apple-system, system-ui, sans-serif;
      --font-mono: 'JetBrains Mono', ui-monospace, monospace;
    }

    html { font-size: 16px; }

    body {
      font-family: var(--font-sans);
      background: var(--background);
      color: var(--foreground);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* ---- HEADER ---- */
    .header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(9, 9, 11, 0.80);
      backdrop-filter: blur(12px) saturate(180%);
      -webkit-backdrop-filter: blur(12px) saturate(180%);
      border-bottom: 1px solid var(--border);
    }

    .header-inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 14px 24px;
      display: flex;
      align-items: center;
      gap: 24px;
    }

    /* Logo */
    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
      flex-shrink: 0;
    }

    .logo-mark {
      width: 28px;
      height: 28px;
      background: var(--accent);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo-mark svg { width: 15px; height: 15px; }

    .logo-text {
      font-weight: 600;
      font-size: 1rem;
      color: var(--foreground);
      letter-spacing: -0.01em;
    }

    .logo-text span {
      color: var(--muted-foreground);
      font-weight: 400;
    }

    /* Nav */
    .nav {
      display: flex;
      gap: 4px;
    }

    .nav a {
      display: inline-flex;
      align-items: center;
      padding: 6px 14px;
      border-radius: calc(var(--radius) - 4px);
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--muted-foreground);
      text-decoration: none;
      transition: color 0.15s, background 0.15s;
    }

    .nav a:hover { color: var(--foreground); background: var(--secondary); }
    .nav a.active { color: var(--foreground); background: var(--secondary); }

    /* Search — shadcn Input style */
    .search-wrapper {
      flex: 1;
      max-width: 480px;
      position: relative;
    }

    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted-foreground);
      pointer-events: none;
    }

    .search-input {
      display: flex;
      height: 40px;
      width: 100%;
      border-radius: calc(var(--radius) - 4px);
      border: 1px solid var(--input);
      background: var(--background);
      padding: 8px 52px 8px 38px;
      font-size: 0.875rem;
      font-family: var(--font-sans);
      color: var(--foreground);
      outline: none;
      transition: border-color 0.15s, box-shadow 0.15s;
    }

    .search-input::placeholder { color: var(--muted-foreground); }

    .search-input:focus {
      border-color: var(--ring);
      box-shadow: 0 0 0 2px var(--background), 0 0 0 4px var(--ring);
    }

    .search-kbd {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
      display: inline-flex;
      align-items: center;
      gap: 2px;
      font-family: var(--font-sans);
      font-size: 0.7rem;
      font-weight: 500;
      color: var(--muted-foreground);
      background: var(--secondary);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 2px 6px;
      line-height: 1;
    }

    .search-input:focus ~ .search-kbd { display: none; }

    /* Header meta */
    .header-meta {
      display: flex;
      align-items: center;
      gap: 16px;
      flex-shrink: 0;
    }

    .icon-count {
      font-size: 0.8rem;
      color: var(--muted-foreground);
      font-variant-numeric: tabular-nums;
    }

    .icon-count strong {
      color: var(--foreground);
      font-weight: 500;
    }

    /* ---- GRID ---- */
    .main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px 24px 120px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(58px, 1fr));
      gap: 0;
    }

    .icon-cell {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 0.5px solid transparent;
      cursor: pointer;
      transition: background 0.12s, border-color 0.12s;
      position: relative;
    }

    .icon-cell:hover {
      background: var(--secondary);
      border-color: var(--border);
      z-index: 10;
    }

    .icon-cell.selected {
      background: var(--accent-subtle);
      border-color: var(--accent);
      z-index: 2;
    }

    .icon-cell svg {
      color: var(--muted-foreground);
      transition: color 0.12s;
    }

    .icon-cell:hover svg { color: var(--foreground); }
    .icon-cell.selected svg { color: var(--accent); }

    /* Tooltip — shadcn Tooltip style */
    .icon-cell::after {
      content: attr(data-name);
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%);
      background: var(--primary);
      color: var(--primary-foreground);
      font-size: 0.75rem;
      font-weight: 500;
      padding: 4px 10px;
      border-radius: calc(var(--radius) - 4px);
      white-space: nowrap;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.1s;
      z-index: 50;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    .icon-cell:hover::after { opacity: 1; }

    /* ---- MODAL OVERLAY ---- */
    .modal-overlay {
      position: fixed;
      inset: 0;
      z-index: 200;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
    }

    .modal-overlay.open {
      opacity: 1;
      pointer-events: auto;
    }

    /* ---- MODAL NAV CHEVRONS ---- */
    .modal-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--muted-foreground);
      cursor: pointer;
      transition: background 0.15s, color 0.15s, border-color 0.15s;
      z-index: 210;
    }

    .modal-nav:hover {
      background: var(--secondary);
      color: var(--foreground);
      border-color: var(--muted-foreground);
    }

    .modal-nav.prev { left: max(12px, calc(50% - 320px)); }
    .modal-nav.next { right: max(12px, calc(50% - 320px)); }

    @media (max-width: 768px) {
      .modal-nav.prev { left: 6px; }
      .modal-nav.next { right: 6px; }
      .modal-nav { width: 34px; height: 34px; }
    }

    /* ---- MODAL DIALOG ---- */
    .modal {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: calc(var(--radius) + 4px);
      box-shadow: 0 16px 64px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.04);
      width: 90vw;
      max-width: 560px;
      max-height: 85vh;
      overflow-y: auto;
      transform: scale(0.96) translateY(8px);
      transition: transform 0.2s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .modal-overlay.open .modal {
      transform: scale(1) translateY(0);
    }

    .modal-inner {
      padding: 28px 28px 24px;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    /* Top row: name + close */
    .modal-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 16px;
    }

    .modal-header .detail-name {
      font-size: 1.125rem;
      font-weight: 600;
      color: var(--foreground);
      letter-spacing: -0.02em;
    }

    .modal-header .detail-tags {
      font-size: 0.8rem;
      color: var(--muted-foreground);
      margin-top: 4px;
    }

    /* Icon preview — centered */
    .detail-preview {
      width: 100%;
      height: 176px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--secondary);
      border: 1px solid var(--border);
      border-radius: var(--radius);
    }

    .detail-preview svg { color: var(--foreground); }

    /* Sections */
    .modal-section {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .detail-section-label {
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--muted-foreground);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .size-options {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .size-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      height: 32px;
      padding: 0 12px;
      border-radius: calc(var(--radius) - 4px);
      font-family: var(--font-mono);
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s, color 0.15s;
      border: 1px solid var(--input);
      background: transparent;
      color: var(--muted-foreground);
      white-space: nowrap;
    }

    .size-btn:hover {
      background: var(--secondary);
      border-color: var(--muted-foreground);
      color: var(--foreground);
    }

    .size-btn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: var(--accent-foreground);
    }

    /* Code block */
    .detail-code {
      font-family: var(--font-mono);
      font-size: 0.8rem;
      color: var(--muted-foreground);
      background: var(--background);
      border: 1px solid var(--border);
      border-radius: calc(var(--radius) - 4px);
      padding: 12px 16px;
      cursor: pointer;
      transition: border-color 0.15s, color 0.15s;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .detail-code:hover {
      border-color: var(--muted-foreground);
      color: var(--foreground);
    }

    .detail-code.copied {
      border-color: #22c55e;
      color: #22c55e;
    }

    /* Action buttons */
    .detail-actions {
      display: flex;
      gap: 8px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      height: 36px;
      padding: 0 16px;
      border-radius: calc(var(--radius) - 4px);
      font-family: var(--font-sans);
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s, color 0.15s, box-shadow 0.15s;
      border: 1px solid transparent;
      white-space: nowrap;
      outline: none;
    }

    .btn:focus-visible {
      box-shadow: 0 0 0 2px var(--background), 0 0 0 4px var(--ring);
    }

    .btn-default {
      background: var(--accent);
      color: var(--accent-foreground);
      border-color: var(--accent);
    }

    .btn-default:hover { filter: brightness(1.12); }

    .btn-outline {
      background: transparent;
      color: var(--foreground);
      border-color: var(--input);
    }

    .btn-outline:hover {
      background: var(--secondary);
      border-color: var(--muted-foreground);
    }

    .btn-ghost {
      background: transparent;
      color: var(--muted-foreground);
      border-color: transparent;
    }

    .btn-ghost:hover {
      background: var(--secondary);
      color: var(--foreground);
    }

    .btn-icon {
      width: 36px;
      height: 36px;
      padding: 0;
    }

    .btn.copied {
      background: #22c55e;
      border-color: #22c55e;
      color: #fff;
    }

    /* ---- KEYBOARD HINTS ---- */
    .modal-shortcuts {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      padding-top: 4px;
    }

    .shortcut-hint {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.7rem;
      color: var(--muted-foreground);
      opacity: 0.6;
    }

    .shortcut-hint kbd {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 20px;
      height: 20px;
      padding: 0 5px;
      border-radius: 4px;
      font-family: var(--font-sans);
      font-size: 0.65rem;
      font-weight: 500;
      background: var(--secondary);
      border: 1px solid var(--border);
      color: var(--muted-foreground);
      line-height: 1;
    }

    /* ---- EMPTY STATE ---- */
    .empty-state {
      grid-column: 1 / -1;
      padding: 80px 24px;
      text-align: center;
    }

    .empty-state svg {
      color: var(--muted-foreground);
      margin-bottom: 16px;
      opacity: 0.3;
    }

    .empty-state p {
      color: var(--muted-foreground);
      font-size: 0.9rem;
    }

    .empty-state .hint {
      margin-top: 6px;
      font-size: 0.8rem;
      opacity: 0.5;
    }

    /* ---- RESPONSIVE ---- */
    @media (max-width: 768px) {
      .header-inner { padding: 12px 16px; gap: 12px; }
      .main { padding: 16px 16px 80px; }
      .grid { grid-template-columns: repeat(auto-fill, minmax(50px, 1fr)); }
      .modal { width: 95vw; }
      .modal-inner { padding: 20px; }
      .detail-preview { height: 120px; }
      .icon-count { display: none; }
      .logo-text { display: none; }
    }
  </style>
</head>
<body>

  <header class="header">
    <div class="header-inner">
      <a class="logo" href="#">
        <div class="logo-mark">
          <svg viewBox="0 0 16 16" fill="none" stroke="#000" stroke-width="2" stroke-linecap="round">
            <circle cx="8" cy="8" r="3" /><path d="M8 2v2M8 12v2M2 8h2M12 8h2" />
          </svg>
        </div>
        <div class="logo-text">BeatStars <span>Icons</span></div>
      </a>

      <nav class="nav">
        <a href="index.html" class="active">Icons</a>
        <a href="deploy.html">Deploy</a>
      </nav>

      <div class="search-wrapper">
        <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
          <circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/>
        </svg>
        <input
          type="text"
          class="search-input"
          id="search"
          placeholder="Search icons…"
          spellcheck="false"
          autocomplete="off"
        />
        <span class="search-kbd">⌘K</span>
      </div>

      <div class="header-meta">
        <span class="icon-count"><strong id="visible-count">0</strong> <span id="count-label">icons</span></span>
      </div>
    </div>
  </header>

  <main class="main">
    <div class="grid" id="grid"></div>
  </main>

  <!-- Modal -->
  <div class="modal-overlay" id="modal-overlay">
    <button class="modal-nav prev" id="nav-prev" title="Previous icon (←)">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
    </button>
    <div class="modal" id="modal">
      <div class="modal-inner">
        <div class="modal-header">
          <div>
            <div class="detail-name" id="detail-name"></div>
            <div class="detail-tags" id="detail-tags"></div>
          </div>
          <button class="btn btn-ghost btn-icon" id="detail-close" title="Close (Esc)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M18 6 6 18M6 6l12 12"/></svg>
          </button>
        </div>
        <div class="detail-preview" id="detail-preview"></div>
        <div class="modal-section">
          <div class="detail-section-label">Size</div>
          <div class="size-options" id="size-options">
            <button class="size-btn" data-size="8">8px</button>
            <button class="size-btn" data-size="12">12px</button>
            <button class="size-btn" data-size="16">16px</button>
            <button class="size-btn active" data-size="24">24px</button>
            <button class="size-btn" data-size="32">32px</button>
            <button class="size-btn" data-size="40">40px</button>
            <button class="size-btn" data-size="64">64px</button>
          </div>
        </div>
        <div class="modal-section">
          <div class="detail-section-label">Import</div>
          <div class="detail-code" id="detail-import" title="Click to copy import"></div>
        </div>
        <div class="modal-section">
          <div class="detail-section-label">Usage</div>
          <div class="detail-code" id="detail-usage" title="Click to copy usage"></div>
        </div>
        <div class="detail-actions">
          <button class="btn btn-default" id="btn-copy-svg">Copy SVG</button>
          <button class="btn btn-outline" id="btn-copy-import">Copy Import</button>
        </div>
        <div class="modal-shortcuts">
          <span class="shortcut-hint"><kbd>←</kbd><kbd>→</kbd> Navigate</span>
          <span class="shortcut-hint"><kbd>C</kbd> Copy SVG</span>
          <span class="shortcut-hint"><kbd>Esc</kbd> Close</span>
        </div>
      </div>
    </div>
    <button class="modal-nav next" id="nav-next" title="Next icon (→)">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
    </button>
  </div>

  <!-- Catalog data -->
  <script src="catalog-data.js"></script>

  <script>
    if (!window.BEATSTARS_ICONS) {
      window.BEATSTARS_ICONS = [
        { name: 'PlayIcon', fileName: 'play', kebab: 'play', tags: ['play','start','media'], svg: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>', importStatement: "import { PlayIcon } from '@beatstars/icons';", jsxUsage: '<PlayIcon size={24} />' },
        { name: 'SearchIcon', fileName: 'search', kebab: 'search', tags: ['search','find'], svg: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>', importStatement: "import { SearchIcon } from '@beatstars/icons';", jsxUsage: '<SearchIcon size={24} />' },
      ];
    }
  </script>

  <script>
    // ---- State ----
    let icons = window.BEATSTARS_ICONS || [];
    let filteredIcons = [...icons];
    let selectedIcon = null;
    let selectedSize = 24;

    // ---- DOM refs ----
    const grid = document.getElementById('grid');
    const searchInput = document.getElementById('search');
    const visibleCount = document.getElementById('visible-count');
    const countLabel = document.getElementById('count-label');
    const modalOverlay = document.getElementById('modal-overlay');
    const modal = document.getElementById('modal');
    const detailPreview = document.getElementById('detail-preview');
    const detailName = document.getElementById('detail-name');
    const detailTags = document.getElementById('detail-tags');
    const detailImport = document.getElementById('detail-import');
    const detailUsage = document.getElementById('detail-usage');
    const detailClose = document.getElementById('detail-close');
    const sizeOptions = document.getElementById('size-options');
    const btnCopySvg = document.getElementById('btn-copy-svg');
    const btnCopyImport = document.getElementById('btn-copy-import');
    const navPrev = document.getElementById('nav-prev');
    const navNext = document.getElementById('nav-next');

    // Dynamic placeholder
    searchInput.placeholder = `Search ${icons.length} icons\u2026`;

    // ---- SVG helper ----
    function scaleSvg(svg, size) {
      return svg.replace(/<svg([^>]*)>/, (match, attrs) => {
        attrs = attrs.replace(/\s+width="[^"]*"/, '').replace(/\s+height="[^"]*"/, '');
        return `<svg width="${size}" height="${size}"${attrs}>`;
      });
    }

    // ---- Render Grid ----
    function renderGrid() {
      if (filteredIcons.length === 0) {
        grid.innerHTML = `
          <div class="empty-state">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
              <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
            </svg>
            <p>No icons match your search</p>
            <p class="hint">Try a different term</p>
          </div>
        `;
      } else {
        grid.innerHTML = filteredIcons.map((icon, i) => `
          <div class="icon-cell${selectedIcon === icon ? ' selected' : ''}"
               data-index="${i}"
               data-name="${icon.kebab}"
               onclick="selectIcon(${i})">
            ${scaleSvg(icon.svg, 24)}
          </div>
        `).join('');
      }

      visibleCount.textContent = filteredIcons.length;
      countLabel.textContent = filteredIcons.length === 1 ? 'icon' : 'icons';
    }

    // ---- Search ----
    function filterIcons(query) {
      const q = query.toLowerCase().trim();
      if (!q) {
        filteredIcons = [...icons];
      } else {
        const terms = q.split(/\s+/);
        filteredIcons = icons.filter((icon) => {
          const searchable = [icon.name, icon.fileName, ...icon.tags].join(' ').toLowerCase();
          return terms.every((term) => searchable.includes(term));
        });
      }
      renderGrid();
    }

    searchInput.addEventListener('input', (e) => filterIcons(e.target.value));

    // ---- Detail Bar ----
    function selectIcon(index) {
      const icon = filteredIcons[index];
      if (selectedIcon === icon) { closeDetail(); return; }
      selectedIcon = icon;
      openDetail();
      renderGrid();
    }

    function updatePreviewSize(size) {
      selectedSize = size;
      if (!selectedIcon) return;
      detailPreview.innerHTML = scaleSvg(selectedIcon.svg, 96);
      const usageText = `<${selectedIcon.name} size={${size}} />`;
      detailUsage.textContent = usageText;
      detailUsage.onclick = () => copyText(usageText, detailUsage);
      sizeOptions.querySelectorAll('.size-btn').forEach(btn => {
        btn.classList.toggle('active', Number(btn.dataset.size) === size);
      });
    }

    function openDetail() {
      if (!selectedIcon) return;
      detailPreview.innerHTML = scaleSvg(selectedIcon.svg, 96);
      detailName.textContent = selectedIcon.kebab;
      detailTags.textContent = selectedIcon.tags.join(' \u2022 ');
      detailImport.textContent = selectedIcon.importStatement;
      detailImport.onclick = () => copyText(selectedIcon.importStatement, detailImport);
      const usageText = `<${selectedIcon.name} size={${selectedSize}} />`;
      detailUsage.textContent = usageText;
      detailUsage.onclick = () => copyText(usageText, detailUsage);
      sizeOptions.querySelectorAll('.size-btn').forEach(btn => {
        btn.classList.toggle('active', Number(btn.dataset.size) === selectedSize);
      });
      modalOverlay.classList.add('open');
    }

    function closeDetail() {
      modalOverlay.classList.remove('open');
      selectedIcon = null;
      renderGrid();
    }

    function navigateIcon(direction) {
      if (!selectedIcon) return;
      const currentIndex = filteredIcons.indexOf(selectedIcon);
      if (currentIndex === -1) return;
      let nextIndex = currentIndex + direction;
      // Wrap around
      if (nextIndex < 0) nextIndex = filteredIcons.length - 1;
      if (nextIndex >= filteredIcons.length) nextIndex = 0;
      selectedIcon = filteredIcons[nextIndex];
      openDetail();
      renderGrid();
    }

    detailClose.addEventListener('click', closeDetail);
    navPrev.addEventListener('click', () => navigateIcon(-1));
    navNext.addEventListener('click', () => navigateIcon(1));

    // Close on backdrop click
    modalOverlay.addEventListener('click', (e) => {
      if (e.target === modalOverlay) closeDetail();
    });

    // ---- Size selector ----
    sizeOptions.addEventListener('click', (e) => {
      const btn = e.target.closest('.size-btn');
      if (!btn) return;
      updatePreviewSize(Number(btn.dataset.size));
    });

    // ---- Copy ----
    btnCopySvg.addEventListener('click', () => {
      if (selectedIcon) copyText(selectedIcon.svg, btnCopySvg);
    });

    btnCopyImport.addEventListener('click', () => {
      if (selectedIcon) copyText(selectedIcon.importStatement, btnCopyImport);
    });

    async function copyText(text, el) {
      try {
        await navigator.clipboard.writeText(text);
        const orig = el.textContent;
        el.textContent = 'Copied!';
        el.classList.add('copied');
        setTimeout(() => {
          el.textContent = orig;
          el.classList.remove('copied');
        }, 1200);
      } catch {}
    }

    // ---- Keyboard ----
    document.addEventListener('keydown', (e) => {
      const isModalOpen = modalOverlay.classList.contains('open');

      if (e.key === 'Escape') { closeDetail(); return; }

      if ((e.key === '/' || (e.metaKey && e.key === 'k')) && document.activeElement !== searchInput) {
        e.preventDefault();
        searchInput.focus();
        return;
      }

      // Modal-only shortcuts (only when not typing in search)
      if (isModalOpen && document.activeElement !== searchInput) {
        if (e.key === 'ArrowLeft') { e.preventDefault(); navigateIcon(-1); return; }
        if (e.key === 'ArrowRight') { e.preventDefault(); navigateIcon(1); return; }
        if (e.key === 'c' && !e.metaKey && !e.ctrlKey && !e.altKey) {
          e.preventDefault();
          if (selectedIcon) copyText(selectedIcon.svg, btnCopySvg);
          return;
        }
      }
    });

    // ---- Init ----
    renderGrid();
  </script>
</body>
</html>
